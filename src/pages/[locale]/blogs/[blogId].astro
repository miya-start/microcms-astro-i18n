---
import { getBlogs, getBlogDetail } from 'library/microcms'
import Article from 'components/Article.astro'
import { langsArr, type Lang } from 'types'

// 生成する記事のIDを全て取得
export async function getStaticPaths() {
  const response = await getBlogs({ fields: ['id'] })
  return langsArr.flatMap((lang) => {
    return response.contents.map((content: any) => ({
      params: {
        blogId: content.id,
        locale: lang,
      },
    }))
  })
}

//記事の詳細情報を取得
const { blogId, locale: lang } = Astro.params as {
  blogId: string
  locale: Lang
}
const blog = await getBlogDetail(blogId as string)
---

<Article blog={blog} lang={lang} />
